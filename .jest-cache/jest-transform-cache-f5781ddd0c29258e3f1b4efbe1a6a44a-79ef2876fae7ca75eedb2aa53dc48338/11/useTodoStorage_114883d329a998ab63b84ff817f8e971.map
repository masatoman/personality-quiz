{"version":3,"sources":["/Users/master/Local Sites/testcursor/src/hooks/useTodoStorage.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\n\nexport type Task = {\n  id: string;\n  title: string;\n  description?: string;\n  points: number;\n  completed: boolean;\n  createdAt: Date;\n  dueDate?: Date;\n  type: 'custom' | 'suggested';\n};\n\nexport type UseTodoStorageReturn = {\n  tasks: Task[];\n  addTask: (task: Omit<Task, 'id' | 'createdAt' | 'completed'>) => void;\n  deleteTask: (id: string) => void;\n  toggleTaskCompletion: (id: string) => void;\n  completedTasks: Task[];\n  incompleteTasks: Task[];\n  totalPoints: number;\n  completedPoints: number;\n};\n\nexport default function useTodoStorage(): UseTodoStorageReturn {\n  const [tasks, setTasks] = useState<Task[]>([]);\n  \n  // ローカルストレージからデータを読み込む\n  useEffect(() => {\n    const storedTasks = localStorage.getItem('todo-tasks');\n    if (storedTasks) {\n      try {\n        // 日付の文字列をDateオブジェクトに変換する必要がある\n        const parsedTasks = JSON.parse(storedTasks, (key, value) => {\n          if (key === 'createdAt' || key === 'dueDate') {\n            return value ? new Date(value) : null;\n          }\n          return value;\n        });\n        setTasks(parsedTasks);\n      } catch (error) {\n        console.error('タスクの読み込みに失敗しました:', error);\n        setTasks([]);\n      }\n    }\n  }, []);\n  \n  // データが変更されたらローカルストレージに保存\n  useEffect(() => {\n    if (tasks.length > 0) {\n      localStorage.setItem('todo-tasks', JSON.stringify(tasks));\n    }\n  }, [tasks]);\n  \n  // タスクの追加\n  const addTask = (taskData: Omit<Task, 'id' | 'createdAt' | 'completed'>) => {\n    const newTask: Task = {\n      ...taskData,\n      id: uuidv4(),\n      createdAt: new Date(),\n      completed: false,\n    };\n    \n    setTasks(prevTasks => [...prevTasks, newTask]);\n  };\n  \n  // タスクの削除\n  const deleteTask = (id: string) => {\n    setTasks(prevTasks => prevTasks.filter(task => task.id !== id));\n  };\n  \n  // タスクの完了状態の切り替え\n  const toggleTaskCompletion = (id: string) => {\n    setTasks(prevTasks => \n      prevTasks.map(task => \n        task.id === id ? { ...task, completed: !task.completed } : task\n      )\n    );\n  };\n  \n  // 完了したタスクと未完了のタスクを分ける\n  const completedTasks = tasks.filter(task => task.completed);\n  const incompleteTasks = tasks.filter(task => !task.completed);\n  \n  // ポイントの計算\n  const totalPoints = tasks.reduce((sum, task) => sum + task.points, 0);\n  const completedPoints = completedTasks.reduce((sum, task) => sum + task.points, 0);\n  \n  return {\n    tasks,\n    addTask,\n    deleteTask,\n    toggleTaskCompletion,\n    completedTasks,\n    incompleteTasks,\n    totalPoints,\n    completedPoints,\n  };\n} "],"names":["useTodoStorage","tasks","setTasks","useState","useEffect","storedTasks","localStorage","getItem","parsedTasks","JSON","parse","key","value","Date","error","console","length","setItem","stringify","addTask","taskData","newTask","id","uuidv4","createdAt","completed","prevTasks","deleteTask","filter","task","toggleTaskCompletion","map","completedTasks","incompleteTasks","totalPoints","reduce","sum","points","completedPoints"],"mappings":";;;;+BAyBA;;;eAAwBA;;;uBAzBY;sBACP;AAwBd,SAASA;IACtB,MAAM,CAACC,OAAOC,SAAS,GAAGC,IAAAA,eAAQ,EAAS,EAAE;IAE7C,sBAAsB;IACtBC,IAAAA,gBAAS,EAAC;QACR,MAAMC,cAAcC,aAAaC,OAAO,CAAC;QACzC,IAAIF,aAAa;YACf,IAAI;gBACF,8BAA8B;gBAC9B,MAAMG,cAAcC,KAAKC,KAAK,CAACL,aAAa,CAACM,KAAKC;oBAChD,IAAID,QAAQ,eAAeA,QAAQ,WAAW;wBAC5C,OAAOC,QAAQ,IAAIC,KAAKD,SAAS;oBACnC;oBACA,OAAOA;gBACT;gBACAV,SAASM;YACX,EAAE,OAAOM,OAAO;gBACdC,QAAQD,KAAK,CAAC,oBAAoBA;gBAClCZ,SAAS,EAAE;YACb;QACF;IACF,GAAG,EAAE;IAEL,yBAAyB;IACzBE,IAAAA,gBAAS,EAAC;QACR,IAAIH,MAAMe,MAAM,GAAG,GAAG;YACpBV,aAAaW,OAAO,CAAC,cAAcR,KAAKS,SAAS,CAACjB;QACpD;IACF,GAAG;QAACA;KAAM;IAEV,SAAS;IACT,MAAMkB,UAAU,CAACC;QACf,MAAMC,UAAgB;YACpB,GAAGD,QAAQ;YACXE,IAAIC,IAAAA,QAAM;YACVC,WAAW,IAAIX;YACfY,WAAW;QACb;QAEAvB,SAASwB,CAAAA,YAAa;mBAAIA;gBAAWL;aAAQ;IAC/C;IAEA,SAAS;IACT,MAAMM,aAAa,CAACL;QAClBpB,SAASwB,CAAAA,YAAaA,UAAUE,MAAM,CAACC,CAAAA,OAAQA,KAAKP,EAAE,KAAKA;IAC7D;IAEA,gBAAgB;IAChB,MAAMQ,uBAAuB,CAACR;QAC5BpB,SAASwB,CAAAA,YACPA,UAAUK,GAAG,CAACF,CAAAA,OACZA,KAAKP,EAAE,KAAKA,KAAK;oBAAE,GAAGO,IAAI;oBAAEJ,WAAW,CAACI,KAAKJ,SAAS;gBAAC,IAAII;IAGjE;IAEA,sBAAsB;IACtB,MAAMG,iBAAiB/B,MAAM2B,MAAM,CAACC,CAAAA,OAAQA,KAAKJ,SAAS;IAC1D,MAAMQ,kBAAkBhC,MAAM2B,MAAM,CAACC,CAAAA,OAAQ,CAACA,KAAKJ,SAAS;IAE5D,UAAU;IACV,MAAMS,cAAcjC,MAAMkC,MAAM,CAAC,CAACC,KAAKP,OAASO,MAAMP,KAAKQ,MAAM,EAAE;IACnE,MAAMC,kBAAkBN,eAAeG,MAAM,CAAC,CAACC,KAAKP,OAASO,MAAMP,KAAKQ,MAAM,EAAE;IAEhF,OAAO;QACLpC;QACAkB;QACAQ;QACAG;QACAE;QACAC;QACAC;QACAI;IACF;AACF"}