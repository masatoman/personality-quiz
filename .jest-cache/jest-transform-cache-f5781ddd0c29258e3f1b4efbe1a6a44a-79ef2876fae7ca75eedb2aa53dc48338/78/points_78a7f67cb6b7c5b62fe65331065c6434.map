{"version":3,"sources":["/Users/master/Local Sites/testcursor/src/utils/points.ts"],"sourcesContent":["/**\n * ポイントユーティリティ関数\n */\n\n/**\n * ポイントを消費する関数\n * \n * @param points 消費するポイント数\n * @param actionType アクションタイプ\n * @param options その他のオプション\n * @returns 消費結果\n */\nexport const consumePoints = async (\n  points: number,\n  actionType: string,\n  options?: {\n    referenceId?: string;\n    referenceType?: string;\n    description?: string;\n  }\n): Promise<{\n  success: boolean;\n  consumedPoints?: number;\n  remainingPoints?: number;\n  error?: string;\n  currentPoints?: number;\n  requiredPoints?: number;\n}> => {\n  try {\n    const response = await fetch('/api/points/consume', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        points,\n        actionType,\n        ...options,\n      }),\n    });\n\n    const result = await response.json();\n    \n    if (!response.ok) {\n      return {\n        success: false,\n        error: result.error || '不明なエラーが発生しました',\n        currentPoints: result.currentPoints,\n        requiredPoints: result.requiredPoints,\n      };\n    }\n\n    return {\n      success: true,\n      consumedPoints: result.consumedPoints,\n      remainingPoints: result.remainingPoints,\n    };\n  } catch (error) {\n    console.error('ポイント消費エラー:', error);\n    return {\n      success: false,\n      error: '通信エラーが発生しました',\n    };\n  }\n};\n\n/**\n * ポイント残高を取得する関数\n * \n * @returns ポイント残高\n */\nexport const fetchPointsBalance = async (): Promise<{\n  success: boolean;\n  points?: number;\n  error?: string;\n}> => {\n  try {\n    const response = await fetch('/api/points/balance');\n    \n    if (!response.ok) {\n      const errorData = await response.json();\n      return {\n        success: false,\n        error: errorData.error || '不明なエラーが発生しました',\n      };\n    }\n    \n    const data = await response.json();\n    \n    return {\n      success: true,\n      points: data.points,\n    };\n  } catch (error) {\n    console.error('ポイント残高取得エラー:', error);\n    return {\n      success: false,\n      error: '通信エラーが発生しました',\n    };\n  }\n};\n\n/**\n * ポイント購入アイテムの定義\n */\nexport const PURCHASABLE_ITEMS = [\n  {\n    id: 'premium_theme',\n    name: 'プレミアムテーマ',\n    description: 'アプリの見た目をカスタマイズできる特別なテーマ',\n    points: 500,\n    category: 'appearance',\n  },\n  {\n    id: 'access_advanced_materials',\n    name: '上級者向け教材アクセス',\n    description: '上級者向けの教材にアクセスできるようになります',\n    points: 300,\n    category: 'content',\n  },\n  {\n    id: 'custom_avatar',\n    name: 'カスタムアバター',\n    description: 'プロフィールに特別なアバターを設定できます',\n    points: 200,\n    category: 'appearance',\n  },\n  {\n    id: 'remove_ads',\n    name: '広告非表示',\n    description: 'アプリ内の広告が表示されなくなります（30日間）',\n    points: 150,\n    category: 'premium',\n  },\n]; "],"names":["PURCHASABLE_ITEMS","consumePoints","fetchPointsBalance","points","actionType","options","response","fetch","method","headers","body","JSON","stringify","result","json","ok","success","error","currentPoints","requiredPoints","consumedPoints","remainingPoints","console","errorData","data","id","name","description","category"],"mappings":"AAAA;;CAEC,GAED;;;;;;;CAOC;;;;;;;;;;;IA8FYA,iBAAiB;eAAjBA;;IA7FAC,aAAa;eAAbA;;IA2DAC,kBAAkB;eAAlBA;;;AA3DN,MAAMD,gBAAgB,OAC3BE,QACAC,YACAC;IAaA,IAAI;QACF,MAAMC,WAAW,MAAMC,MAAM,uBAAuB;YAClDC,QAAQ;YACRC,SAAS;gBACP,gBAAgB;YAClB;YACAC,MAAMC,KAAKC,SAAS,CAAC;gBACnBT;gBACAC;gBACA,GAAGC,OAAO;YACZ;QACF;QAEA,MAAMQ,SAAS,MAAMP,SAASQ,IAAI;QAElC,IAAI,CAACR,SAASS,EAAE,EAAE;YAChB,OAAO;gBACLC,SAAS;gBACTC,OAAOJ,OAAOI,KAAK,IAAI;gBACvBC,eAAeL,OAAOK,aAAa;gBACnCC,gBAAgBN,OAAOM,cAAc;YACvC;QACF;QAEA,OAAO;YACLH,SAAS;YACTI,gBAAgBP,OAAOO,cAAc;YACrCC,iBAAiBR,OAAOQ,eAAe;QACzC;IACF,EAAE,OAAOJ,OAAO;QACdK,QAAQL,KAAK,CAAC,cAAcA;QAC5B,OAAO;YACLD,SAAS;YACTC,OAAO;QACT;IACF;AACF;AAOO,MAAMf,qBAAqB;IAKhC,IAAI;QACF,MAAMI,WAAW,MAAMC,MAAM;QAE7B,IAAI,CAACD,SAASS,EAAE,EAAE;YAChB,MAAMQ,YAAY,MAAMjB,SAASQ,IAAI;YACrC,OAAO;gBACLE,SAAS;gBACTC,OAAOM,UAAUN,KAAK,IAAI;YAC5B;QACF;QAEA,MAAMO,OAAO,MAAMlB,SAASQ,IAAI;QAEhC,OAAO;YACLE,SAAS;YACTb,QAAQqB,KAAKrB,MAAM;QACrB;IACF,EAAE,OAAOc,OAAO;QACdK,QAAQL,KAAK,CAAC,gBAAgBA;QAC9B,OAAO;YACLD,SAAS;YACTC,OAAO;QACT;IACF;AACF;AAKO,MAAMjB,oBAAoB;IAC/B;QACEyB,IAAI;QACJC,MAAM;QACNC,aAAa;QACbxB,QAAQ;QACRyB,UAAU;IACZ;IACA;QACEH,IAAI;QACJC,MAAM;QACNC,aAAa;QACbxB,QAAQ;QACRyB,UAAU;IACZ;IACA;QACEH,IAAI;QACJC,MAAM;QACNC,aAAa;QACbxB,QAAQ;QACRyB,UAAU;IACZ;IACA;QACEH,IAAI;QACJC,MAAM;QACNC,aAAa;QACbxB,QAAQ;QACRyB,UAAU;IACZ;CACD"}