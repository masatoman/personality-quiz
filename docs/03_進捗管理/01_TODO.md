# ShiftWith MVP完成に向けたTODOリスト

## 関連ドキュメント

- [完了機能リスト](./02_完了機能リスト.md) - 実装済み機能の一覧
- [機能の優先順位とスケジュール](../01_プロジェクト概要/04_機能の優先順位とスケジュール.md) - 実装計画
- [テストガイド](../02_開発ガイド/03_テストガイド.md) - テスト実行と設定方法

## 🔥 最優先タスク (Week 1)

### ポイントシステム完成
- [x] ポイント履歴テーブル実装 (`points_history`)
  - [x] 単体テスト完了
  - [x] 機能内結合テスト完了
- [x] ポイント付与トリガーの実装
  - [x] 教材作成時のポイント付与
    - [x] 単体テスト完了
    - [x] 機能内結合テスト完了
  - [x] 教材利用時のポイント付与
    - [x] 単体テスト完了
    - [x] 機能内結合テスト完了
  - [x] ギバー診断完了時のポイント付与
    - [x] 単体テスト完了
    - [x] 機能内結合テスト完了
- [x] ポイント消費ロジック実装
  - [x] 単体テスト完了
  - [x] 機能内結合テスト完了
- [x] ギバースコア計算アルゴリズムの最終化
  - [x] 時間経過による減衰ロジック
    - [x] 単体テスト完了
    - [x] 機能内結合テスト完了
  - [x] 教材タイプによる重み付け
    - [x] 単体テスト完了
    - [x] 機能内結合テスト完了

### ユーザーダッシュボード強化
- [ ] ダッシュボードページの基本レイアウト実装
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] 活動サマリーコンポーネント作成
  - [ ] 作成した教材数表示
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
  - [ ] 獲得ポイント表示
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
  - [ ] 閲覧した教材数表示
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
- [ ] データ可視化チャート実装
  - [ ] ギバースコア推移グラフ
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
  - [ ] 活動種類別の円グラフ
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
- [x] 今日のレコメンド機能実装
  - [x] 単体テスト完了
  - [ ] 機能内結合テスト完了

### テスト標準の実装
- [x] テスト構造の標準化
  - [x] 各ディレクトリのテスト命名規則適用
  - [x] コロケーション方式への移行計画作成
  - [x] CIパイプラインでのテスト実行確認
- [x] テスト種類ごとの標準テンプレート作成
  - [x] 単体テストテンプレート作成
  - [x] 機能内結合テストテンプレート作成
  - [x] 機能間結合テストテンプレート作成
  - [x] 統合テストテンプレート作成
  - [x] E2Eテストテンプレート作成
- [x] テストカバレッジレポート設定
  - [x] Jest設定の見直し
  - [x] カバレッジ可視化の実装

## ⚙️ 機能統合とテスト (Week 2)

### ディレクトリ構造リファクタリング
- [ ] コンポーネント構造の整理
  - [ ] 共通コンポーネントと機能別コンポーネントの分離
  - [ ] 巨大コンポーネントの分割（`ResultsClient.tsx`など）
  - [ ] ディレクトリナビゲーション記法の統一
- [ ] 重複ディレクトリの解消
  - [ ] `src/app/quiz`と`src/quiz`の統合
  - [ ] `src/app/api`と`src/api`の統合
  - [ ] `src/pages`と`src/app`の段階的移行計画作成
- [ ] テスト構造の再配置
  - [ ] 各テストファイルをコロケーション方式（`/test/`ディレクトリ）に移行
  - [ ] テストファイル命名規則の統一
    - [ ] 単体テスト: `[ファイル名].unit.test.(ts|tsx)`
    - [ ] 機能内結合テスト: `[機能名].integration.test.(ts|tsx)`
    - [ ] 機能間結合テスト: `[テストシナリオ名].cy.ts`
    - [ ] 統合テスト: `[テストシナリオ名].cy.ts`
    - [ ] E2Eテスト: `[機能名].e2e.test.ts`

### エラーハンドリングと例外処理
- [ ] グローバルエラーハンドラーの実装
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] フォーム入力バリデーション強化
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] 非認証ユーザーリダイレクト処理
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] オフライン状態の処理改善
  - [ ] 単体テスト完了
- [ ] データロード中の状態表示改善
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了

### エッジケース対応
- [ ] データ不足時の表示処理
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] 大量データ時のパフォーマンス対策
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
  - [ ] パフォーマンステスト完了
- [ ] モバイルデバイス最適化
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] 画像読み込み失敗時のフォールバック
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] 長文コンテンツのハンドリング
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了

### パフォーマンス最適化
- [ ] コンポーネントのメモ化
  - [ ] 単体テスト完了
  - [ ] パフォーマンステスト完了
- [ ] 画像の遅延読み込み実装
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
  - [ ] パフォーマンステスト完了
- [ ] APIレスポンスのキャッシュ戦略
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
  - [ ] パフォーマンステスト完了
- [ ] バンドルサイズ最適化
  - [ ] ビルド分析完了
  - [ ] パフォーマンステスト完了
- [ ] クエリパフォーマンス改善
  - [ ] 単体テスト完了
  - [ ] パフォーマンステスト完了

### 機能仕様書作成
- [ ] 優先機能の仕様書作成
  - [ ] ギバー診断システム仕様書
  - [ ] ポイントシステム仕様書
  - [ ] 教材システム仕様書
  - [ ] ユーザーダッシュボード仕様書
- [ ] 仕様ドキュメントのレビュー
  - [ ] 技術チームによるレビュー
  - [ ] ステークホルダーによるレビュー
- [ ] 仕様と実装の整合性確認
  - [ ] 既存実装との差分分析
  - [ ] 必要に応じた実装調整

## 📚 コンテンツ充実化 (Week 2-3)

### 初期教材コンテンツ
- [ ] 英語学習基本教材（10件）
  - [ ] 初級者向け教材（3件）
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
  - [ ] 中級者向け教材（5件）
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
  - [ ] 上級者向け教材（2件）
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
- [ ] 教材カテゴリーの整理
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] サンプルクイズコンテンツ作成
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了

### ギバー診断システム充実
- [ ] 診断結果解説のコンテンツ強化
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] 各ギバータイプ別アドバイス作成
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] 診断結果共有機能の実装
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] ギバースコア向上のためのヒント追加
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了

## 🧪 テストシナリオ (Week 2-4)

### 機能間結合テスト
- [ ] ユーザー登録からギバー診断までのフロー
  - [ ] ユーザー登録完了後にギバー診断が表示される
  - [ ] ギバー診断の回答がデータベースに保存される
- [ ] ギバー診断完了からダッシュボード表示までのフロー
  - [ ] 診断結果に基づいたレコメンドが表示される
  - [ ] 診断結果に応じたポイント付与が行われる
- [ ] 教材作成からポイント付与までのフロー
  - [ ] 教材保存時にポイントが付与される
  - [ ] ポイント履歴に正しく記録される
- [ ] 教材利用からポイント付与までのフロー
  - [ ] 教材完了時にポイントが付与される
  - [ ] 学習進捗が正しく記録される
- [ ] ポイント消費と機能利用のフロー
  - [ ] 特典利用時にポイントが消費される
  - [ ] 残高不足時に適切なエラーが表示される
- [ ] 教材検索から学習完了までのフロー
  - [ ] 検索結果から教材詳細に正しく遷移する
  - [ ] 教材利用履歴が正しく記録される

### 統合テスト
- [ ] ポイントシステム全体フロー
  - [ ] ポイント獲得〜消費〜残高更新の一連の流れ
  - [ ] ギバースコア計算と表示の整合性
  - [ ] 複数の獲得・消費パターンでの動作検証
- [ ] 教材システム全体フロー
  - [ ] 教材作成〜公開〜検索〜利用の一連の流れ
  - [ ] コンテンツタイプ（動画、テキスト、クイズ）別の動作検証
  - [ ] 複数ユーザー間での教材共有の検証
- [ ] ギバー診断システム全体フロー
  - [ ] 診断実施〜結果表示〜アドバイス提示の一連の流れ
  - [ ] 診断結果とギバースコアの連携
  - [ ] 診断結果に基づくパーソナライズの検証
- [ ] ユーザーダッシュボード全体フロー
  - [ ] 活動データ収集〜集計〜表示の一連の流れ
  - [ ] データ可視化の正確性検証
  - [ ] 時間経過に伴うデータ更新の検証

### E2Eテスト
- [ ] 新規ユーザー完全フロー
  - [ ] 登録〜初期診断〜初回教材利用〜ポイント獲得
  - [ ] 全ブラウザ（Chrome、Firefox、Safari）での検証
- [ ] 教材作者フロー
  - [ ] 教材作成〜公開〜フィードバック確認〜改善
  - [ ] モバイル・PC両方での操作検証
- [ ] 学習者フロー
  - [ ] 教材検索〜学習〜進捗記録〜復習
  - [ ] オフライン状態からの回復検証
- [ ] ギバー活動報酬サイクルフロー
  - [ ] 複数ギバー活動〜ポイント獲得〜レベルアップ〜特典利用
  - [ ] 長期間（日をまたぐ）の利用シミュレーション
- [ ] 異常系シナリオ
  - [ ] ネットワークエラー発生時の動作検証
  - [ ] データロードエラー時のフォールバック確認
  - [ ] 不正入力時のバリデーション確認

## 🔒 セキュリティと最終調整 (Week 3)

### セキュリティ強化
- [ ] 認証フローの完全テスト
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
  - [ ] セキュリティテスト完了
- [ ] 権限管理の実装と確認
  - [ ] 管理者権限の実装
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
    - [ ] セキュリティテスト完了
  - [ ] 編集権限の制限
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
    - [ ] セキュリティテスト完了
- [ ] データバリデーションの強化
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
  - [ ] セキュリティテスト完了
- [ ] CSRFトークン実装
  - [ ] 単体テスト完了
  - [ ] セキュリティテスト完了
- [ ] API Rate Limiting実装
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
  - [ ] 負荷テスト完了

### バックエンドテスト
- [ ] Supabase APIテスト
  - [ ] 認証APIテスト
  - [ ] データベースAPIテスト
  - [ ] ストレージAPIテスト
- [ ] データベーステスト
  - [ ] スキーマ検証テスト
  - [ ] マイグレーションテスト
  - [ ] データ整合性テスト
- [ ] バックエンドセキュリティテスト
  - [ ] Row Level Security (RLS)ポリシーテスト
  - [ ] APIエンドポイントセキュリティテスト
  - [ ] ロール権限テスト

### デプロイ準備
- [ ] 環境変数の確認と設定
  - [ ] 検証環境テスト完了
  - [ ] 本番環境テスト完了
- [ ] 本番ビルド最適化
  - [ ] ビルドパフォーマンステスト完了
  - [ ] 実行パフォーマンステスト完了
- [ ] ログ記録機能の実装
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了
- [ ] バックアップ戦略の確立
  - [ ] リカバリーテスト完了
- [ ] ステージング環境での最終テスト
  - [ ] 負荷テスト完了
  - [ ] セキュリティテスト完了

## 🧪 QAとユーザーテスト (Week 3-4)

### テスト計画
- [ ] 単体テストの拡充
  - [ ] カバレッジ80%達成
  - [ ] 重要機能100%達成
- [ ] E2Eテストシナリオ作成と実行
  - [ ] コアユーザーフロー網羅
  - [ ] エッジケース対応
- [ ] クロスブラウザテスト
  - [ ] Chrome、Firefox、Safari、Edgeテスト完了
  - [ ] モバイルブラウザテスト完了
- [ ] レスポンシブデザインテスト
  - [ ] モバイル対応テスト完了
  - [ ] タブレット対応テスト完了
  - [ ] デスクトップ対応テスト完了
- [ ] パフォーマンステスト
  - [ ] ページロード速度基準達成
  - [ ] インタラクション応答基準達成

### ユーザー受け入れテスト
- [ ] テストユーザーの選定
  - [ ] 初心者ユーザー選定（3名）
  - [ ] 中級者ユーザー選定（3名）
  - [ ] 上級者ユーザー選定（2名）
  - [ ] 教材作成経験者選定（2名）
- [ ] テストシナリオの作成
  - [ ] 新規ユーザー登録〜初期診断フロー
  - [ ] 教材探索〜学習フロー
  - [ ] 教材作成フロー
  - [ ] フィードバック提供フロー
  - [ ] ポイント獲得〜使用フロー
- [ ] テスト環境準備
  - [ ] テストアカウント準備
  - [ ] テスト用データセット準備
  - [ ] テスト実施手順書作成
- [ ] フィードバック収集方法確立
  - [ ] アンケートフォーム作成
  - [ ] インタビュー質問リスト作成
  - [ ] 行動観察シート準備
- [ ] テスト結果分析
  - [ ] 定量データ分析計画
  - [ ] 定性データ分析計画
  - [ ] 優先改善項目特定プロセス

### 情報設計と実装の整合性確認
- [ ] サイトマップと実装の対応確認
  - [ ] 全画面の実装状況チェック
  - [ ] 画面遷移の整合性確認
- [ ] ユーザーフローの検証
  - [ ] 主要フローの実装完了確認
  - [ ] フロー間の接続確認
- [ ] 情報構造の実装確認
  - [ ] 各画面の情報要素の確認
  - [ ] データ表示の一貫性チェック

## 📈 分析と計測の準備

### 分析基盤
- [ ] Googleアナリティクスの設定
  - [ ] 単体テスト完了
- [ ] イベントトラッキングの実装
  - [ ] ユーザー登録完了イベント
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
  - [ ] ギバー診断完了イベント
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
  - [ ] 教材作成イベント
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
  - [ ] 教材利用イベント
    - [ ] 単体テスト完了
    - [ ] 機能内結合テスト完了
- [ ] コンバージョン目標の設定
  - [ ] 単体テスト完了
- [ ] ユーザーフロー分析の準備
  - [ ] 単体テスト完了
- [ ] A/Bテスト基盤の構築
  - [ ] 単体テスト完了
  - [ ] 機能内結合テスト完了

## 🚀 ローンチチェックリスト

### MVPリリース前の最終確認
- [ ] ドキュメント完成
  - [ ] ユーザーガイド
  - [ ] 管理者ガイド
  - [ ] API文書
- [ ] SEO対策
  - [ ] メタタグ最適化
    - [ ] 単体テスト完了
  - [ ] サイトマップ作成
    - [ ] 単体テスト完了
  - [ ] OGタグ設定
    - [ ] 単体テスト完了
- [ ] アクセシビリティチェック
  - [ ] 自動テスト完了
  - [ ] 手動テスト完了
- [ ] 法的要件の確認
  - [ ] プライバシーポリシー
  - [ ] 利用規約
- [ ] バックアップと復旧計画の確認
  - [ ] リカバリーテスト完了

---

## 進捗管理指針

### 優先度レベル
- **P0**: ブロッカー課題（すぐに対応）
- **P1**: 高優先度（MVPに必須）
- **P2**: 中優先度（MVPにあれば望ましい）
- **P3**: 低優先度（MVPローンチ後に対応可）

### ステータス定義
- **未着手**: まだ作業開始していない
- **実装中**: 現在コーディング作業中
- **テスト中**: 実装完了、各種テスト実行中
- **レビュー待ち**: コードレビュー/確認待ち
- **完了**: 実装・全テスト完了

### テスト完了の定義
- **単体テスト**: 個別の関数・コンポーネントの機能テスト完了
- **機能内結合テスト**: 一つの機能内でのコンポーネント間連携テスト完了
- **機能間結合テスト**: 複数の機能間のコンポーネント連携テスト完了
- **統合テスト**: 複数機能間の連携による全体フローテスト完了
- **E2Eテスト**: Playwrightによるエンドツーエンドのユーザーフロー全体テスト完了
- **全テスト**: すべてのテストケースが成功し、80%以上のカバレッジ達成

### 日次確認事項
- スタンドアップで各タスクの進捗報告（実装・テスト状況を含む）
- テスト失敗の報告とブロッカーの特定
- 必要に応じた優先度の再調整
- テスト完了したタスクの共有とレビュー依頼 