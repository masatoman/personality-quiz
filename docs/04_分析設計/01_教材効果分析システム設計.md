# 教材効果分析システム設計書

## 概要
ShiftWithプラットフォームにおける教材の効果測定・分析システムの設計書

## 分析目標
1. **教材効果の定量化**: どの教材がどの程度学習効果があるか
2. **ユーザー特性との相関**: どんな人にどんな教材が効果的か
3. **コンテンツ品質向上**: より効果的な教材作成のためのガイドライン策定

## データ収集項目

### 1. 基本エンゲージメント指標
```sql
-- materials_analytics テーブル設計
CREATE TABLE materials_analytics (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  material_id UUID REFERENCES materials(id),
  user_id UUID REFERENCES users(id),
  
  -- 基本行動データ
  viewed_at TIMESTAMP DEFAULT NOW(),
  time_spent_seconds INTEGER, -- 滞在時間
  scroll_depth_percent INTEGER, -- スクロール深度
  completed BOOLEAN DEFAULT FALSE, -- 完了フラグ
  
  -- エンゲージメントデータ
  clicked_elements JSONB, -- クリックした要素
  quiz_attempts INTEGER DEFAULT 0,
  quiz_score DECIMAL(5,2), -- クイズスコア
  
  -- フィードバックデータ
  rating INTEGER CHECK (rating >= 1 AND rating <= 5),
  difficulty_rating INTEGER CHECK (difficulty_rating >= 1 AND difficulty_rating <= 5),
  usefulness_rating INTEGER CHECK (usefulness_rating >= 1 AND usefulness_rating <= 5),
  
  -- メタデータ
  device_type VARCHAR(50),
  browser_type VARCHAR(50),
  screen_resolution VARCHAR(20),
  
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### 2. 学習効果測定
```sql
-- learning_progress_analytics テーブル
CREATE TABLE learning_progress_analytics (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  material_id UUID REFERENCES materials(id),
  
  -- 学習前後の能力測定
  pre_test_score DECIMAL(5,2),
  post_test_score DECIMAL(5,2),
  improvement_score DECIMAL(5,2), -- 向上度
  
  -- 知識定着測定（1週間後、1ヶ月後など）
  retention_test_1week DECIMAL(5,2),
  retention_test_1month DECIMAL(5,2),
  
  -- 応用力測定
  application_success_rate DECIMAL(5,2),
  real_world_usage BOOLEAN,
  
  measured_at TIMESTAMP DEFAULT NOW()
);
```

### 3. コンテンツ品質指標
```sql
-- content_quality_metrics テーブル
CREATE TABLE content_quality_metrics (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  material_id UUID REFERENCES materials(id),
  
  -- 自動計算指標
  readability_score DECIMAL(5,2), -- 可読性スコア
  complexity_level INTEGER, -- 複雑度レベル
  estimated_reading_time INTEGER, -- 推定読了時間
  
  -- コミュニティ評価
  average_rating DECIMAL(3,2),
  helpful_comment_ratio DECIMAL(5,2), -- 役立つコメントの割合
  expert_endorsement_count INTEGER, -- 専門家の推奨数
  
  -- 効果指標
  completion_rate DECIMAL(5,2),
  return_rate DECIMAL(5,2), -- 再訪率
  recommendation_score DECIMAL(5,2), -- 推奨スコア
  
  calculated_at TIMESTAMP DEFAULT NOW()
);
```

## 分析機能

### 1. 教材効果ダッシュボード
- **基本統計**: 閲覧数、完了率、評価、コメント数
- **学習者属性別分析**: レベル別、パーソナリティ別効果
- **時系列分析**: エンゲージメント推移、季節性分析
- **比較分析**: 同カテゴリ教材との比較

### 2. ユーザー学習パターン分析
- **学習スタイル特定**: 視覚型、聴覚型、体験型の判定
- **最適学習時間帯**: 個人の集中力ピーク時間特定
- **継続要因分析**: 長期継続ユーザーの共通パターン
- **つまずきポイント**: 離脱が多い箇所の特定

### 3. コンテンツ最適化提案
- **構成改善**: より効果的な教材構造の提案
- **難易度調整**: ターゲット層に最適な難易度設定
- **視覚要素最適化**: 図表、色使い、レイアウトの改善提案
- **インタラクション改善**: より参加型のコンテンツ設計

## 実装フェーズ

### フェーズ1: 基本データ収集（即時）
- [ ] 基本エンゲージメント指標の収集開始
- [ ] 既存データの分析基盤構築
- [ ] シンプルなダッシュボード作成

### フェーズ2: 高度分析（3-6ヶ月）
- [ ] 学習効果測定システム構築
- [ ] A/Bテスト機能実装
- [ ] ユーザー特性分析機能

### フェーズ3: AI活用（6-12ヶ月）
- [ ] 自然言語処理による内容分析
- [ ] 機械学習による最適化提案
- [ ] 予測分析機能実装

## 期待される成果

1. **教材クリエイター支援**
   - データに基づく改善提案
   - 効果的な教材作成ガイドライン
   - 個人の強みを活かした教材タイプ特定

2. **学習者体験向上**
   - 個人最適化された学習パス
   - より効果的な教材推奨
   - 学習進捗の可視化

3. **プラットフォーム価値向上**
   - 高品質コンテンツの蓄積
   - データドリブンな機能改善
   - 競合優位性の確立

## 技術要件

### データベース
- PostgreSQL（分析用データウェアハウス）
- 時系列データ処理最適化
- 大量データ対応インデックス設計

### 分析ツール
- Python（pandas, scikit-learn）
- R（統計分析専用）
- BI ツール（Tableau, PowerBI等）

### 可視化
- Chart.js（リアルタイム表示）
- D3.js（カスタム可視化）
- Next.js ダッシュボード

## プライバシー・倫理配慮

1. **データ匿名化**: 個人識別不可能な形でのデータ処理
2. **透明性**: ユーザーへの分析目的・方法の明示
3. **オプトアウト**: データ収集拒否の選択肢提供
4. **セキュリティ**: 分析データの厳重な管理・保護

---

この分析システムにより、ShiftWithは「データに基づく継続的改善」を実現し、
より効果的な学習体験を提供できるプラットフォームへと進化します。
